<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Class Curtain - Accessories</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" href="logoo.png" type="image/png">
    
    <style>
        /* Styles from index.html */
        .hero { position: relative; overflow: hidden; transition: background-image 1s ease-in-out; background-size: cover; background-position: center; }
        .hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 1; }
        .hero h2, .hero p, .hero button { position: relative; z-index: 2; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7); }
        nav { position: sticky; top: 0; left: 0; right: 0; z-index: 1000; }
        .fade-in { opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease-out, transform 0.5s ease-out; }
        .fade-in.visible { opacity: 1; transform: translateY(0); }

        /* Page-specific styles from accessories.html */
        .product-card {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .quantity-input {
            width: 40px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 4px 0;
        }
    </style>

    <script type="module">
        import { createClient } from 'https://esm.sh/@supabase/supabase-js'
        const SUPABASE_URL = 'https://xyvqvcfdkvvbagqxygwo.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh5dnF2Y2Zka3Z2YmFncXh5Z3dvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3NTAzMjUsImV4cCI6MjA3MzMyNjMyNX0.y9mp2CwTpmBfeu03iQx_2khV2F3SD_xhFTih3WMoMMA';
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        window.supabase = supabase;
    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 'playfair': ['"Playfair Display"', 'serif'], 'poppins': ['Poppins', 'sans-serif'] },
                    colors: { 'primary': '#1a1b4b', 'secondary': '#e6f3ff' }
                }
            }
        };

        // --- Functions from index.html (and accessories.html) ---
        function toggleMenu() { document.getElementById('mobile-menu').classList.toggle('hidden'); }

        const images = ['bigi1.jpg', 'bigi2.jpg', 'bigi3.jpg'];
        let currentIndex = 0;
        function changeBackground() {
            const heroSection = document.querySelector('.hero');
            if (heroSection) {
                currentIndex = (currentIndex + 1) % images.length;
                heroSection.style.backgroundImage = `url('${images[currentIndex]}')`;
            }
        }
        
        function handleScroll() {
            const elements = document.querySelectorAll('.fade-in');
            const windowHeight = window.innerHeight;
            elements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                if (elementTop < windowHeight - 50) {
                    element.classList.add('visible');
                }
            });
        }

        // --- Function specific to accessories.html ---
        function updateTotalPrice(inputElement, isInitialLoad = false) {
            const productCard = inputElement.closest('.product-card');
            const unitPrice = parseFloat(productCard.dataset.productPrice);
            let quantity = parseInt(inputElement.value);

            if (isNaN(quantity) || quantity < 1) {
                quantity = 1;
                if (!isInitialLoad) {
                    inputElement.value = 1;
                }
            }
            const totalPrice = unitPrice * quantity;
            const priceSpan = productCard.querySelector('.product-price-display');
            if (priceSpan) {
                priceSpan.textContent = `â‚± ${totalPrice.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            }
        }

        // --- Event Listeners ---
        window.addEventListener('scroll', handleScroll);
        setInterval(changeBackground, 5000); 

        document.addEventListener('DOMContentLoaded', () => {
            handleScroll(); // Check scroll on load
            
            // Attach mobile menu click listener (from index.html)
            const menuBtn = document.getElementById('menu-btn');
            if (menuBtn) {
                menuBtn.addEventListener('click', toggleMenu);
            }
            
            // Initial price setup (from accessories.html)
            document.querySelectorAll('.quantity-input').forEach(input => updateTotalPrice(input, true));
            
            // Initial background (from accessories.html, moved here for clarity)
            const heroSection = document.querySelector('.hero');
            if (heroSection) {
                heroSection.style.backgroundImage = `url('${images[currentIndex]}')`;
            }
        });
    </script>
</head>
<body class="font-poppins bg-gray-50">

    <nav class="bg-white py-4 px-6 md:px-12 shadow-md">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="flex items-center text-2xl font-playfair font-bold text-primary">
                <img src="logoo.png" alt="World Class Curtain Logo" class="h-10 mr-2">
                World Class Curtain
            </a>
            
            <div class="flex items-center space-x-4 md:hidden">
                <a href="cart.html" class="hover:text-primary relative">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <span id="cart-item-count-mobile" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </a>
                <div class="">
                    <img src="menuuu.png" alt="Menu Button" class="menu-btn cursor-pointer h-8 w-8" id="menu-btn">
                </div>
            </div>
            <div class="hidden md:flex space-x-8 items-center">
                <a href="index.html" class="hover:text-primary">HOME</a>
                <a href="inquiries.html" class="hover:text-primary">INQUIRIES</a>
                <a href="accesories.html" class="hover:text-primary">ACCESSORIES</a>
                <a href="seemore.html" class="hover:text-primary">MORE</a>
                <a href="contact.html" class="hover:text-primary">CONTACT</a>
                <div id="auth-links" class="flex space-x-4 items-center"></div> 
                
                <a href="cart.html" class="hover:text-primary relative">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <span id="cart-item-count-desktop" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </a>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white py-4 px-6">
            <a href="index.html" class="block hover:text-primary py-2">HOME</a>
            <a href="inquiries.html" class="hover:text-primary">INQUIRIES</a>
            <a href="accesories.html" class="hover:text-primary">ACCESSORIES</a>
            <a href="seemore.html" class="block hover:text-primary py-2">MORE</a>
            <a href="contact.html" class="block hover:text-primary py-2">CONTACT</a>
            <div id="mobile-auth-links" class="mt-2 space-y-1"></div> 
        </div>
    </nav>
    
    <section id="user-welcome" class="hidden py-8 bg-secondary fade-in text-center">
        <h2 class="text-2xl font-playfair font-bold text-primary">Welcome Back!</h2>
        <p id="user-email-display" class="text-gray-600"></p>
    </section>

    <section class="hero bg-secondary py-16 md:py-24 bg-cover bg-center" style="background-image: url('bigi1.jpg');">
        <div class="container mx-auto px-6 md:px-12 relative z-10">
            <div class="max-w-2xl text-center md:text-left mx-auto md:mx-0">
                <h2 class="text-4xl md:text-5xl font-playfair font-bold text-white mb-4">Curtains That<br/>Reflect your Style</h2>
                <p class="text-white mb-8">Explore The Elegance of World - Class<br/>Curtains, where Luxury Meets<br/>Functionality.</p>
                <button class="bg-primary text-white px-8 py-3 rounded transition hover:bg-opacity-90" onclick="window.location.href='seemore.html'">
                    Explore Now
                </button>
            </div>
        </div>
    </section>

    <section class="py-16 bg-white fade-in">
        <div class="container mx-auto px-6 md:px-12">
            <h2 class="text-3xl font-playfair font-bold text-primary text-center mb-4">Our Accessories</h2>
            <p class="text-center text-gray-600 mb-12">Discover a range of accessories designed to complement your curtains. Click 'Add to Cart' to start your order!</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
                     data-product-name="Elegant Curtain Tiebacks" data-product-price="750">
                    <div>
                        <div class="h-64 rounded-lg mb-4 overflow-hidden">
                            <img src="acce1.jpg" alt="Elegant curtain tiebacks" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                        </div>
                        <h3 class="font-medium mb-2">Elegant Curtain Tiebacks</h3>
                        <p class="text-gray-600 mb-2 flex-grow">Add a touch of elegance to your curtains with our beautifully designed tiebacks.</p>
                        <div class="flex flex-col space-y-2 mb-4 items-center">
                            <label for="qty-1" class="text-sm font-medium">Quantity:</label>
                            <input type="number" id="qty-1" value="1" min="1" class="quantity-input border p-1 rounded-md w-16 text-center" oninput="updateTotalPrice(this)" onchange="this.value = Math.max(1, this.value || 1)">
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-lg product-price-display">â‚± 750</span> 
                            <div class="flex items-center"><span>4.5</span><i class="fas fa-star text-yellow-400 ml-1"></i></div>
                        </div>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>
                
                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
                     data-product-name="Durable Curtain Clips" data-product-price="750">
                    <div>
                        <div class="h-64 rounded-lg mb-4 overflow-hidden">
                            <img src="acce2.jpg" alt="Durable curtain clips" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                        </div>
                        <h3 class="font-medium mb-2">Durable Curtain Clips</h3>
                        <p class="text-gray-600 mb-2 flex-grow">Keep your curtains in place with our durable and stylish clips.</p>
                         <div class="flex flex-col space-y-2 mb-4 items-center">
                            <label for="qty-2" class="text-sm font-medium">Quantity:</label>
                            <input type="number" id="qty-2" value="1" min="1" class="quantity-input border p-1 rounded-md w-16 text-center" oninput="updateTotalPrice(this)" onchange="this.value = Math.max(1, this.value || 1)">
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-lg product-price-display">â‚± 750</span>
                            <div class="flex items-center"><span>4.7</span><i class="fas fa-star text-yellow-400 ml-1"></i></div>
                        </div>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>

                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
                     data-product-name="Luxury Tassel Tiebacks" data-product-price="600">
                    <div>
                        <div class="h-64 rounded-lg mb-4 overflow-hidden">
                            <img src="acce3.jpg" alt="Luxury tassel tiebacks" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                        </div>
                        <h3 class="font-medium mb-2">Luxury Tassel Tiebacks</h3>
                        <p class="text-gray-600 mb-2 flex-grow">Add a luxurious touch to your curtains with our elegant tassel tiebacks.</p>
                         <div class="flex flex-col space-y-2 mb-4 items-center">
                            <label for="qty-3" class="text-sm font-medium">Quantity:</label>
                            <input type="number" id="qty-3" value="1" min="1" class="quantity-input border p-1 rounded-md w-16 text-center" oninput="updateTotalPrice(this)" onchange="this.value = Math.max(1, this.value || 1)">
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-lg product-price-display">â‚± 600</span>
                            <div class="flex items-center"><span>4.6</span><i class="fas fa-star text-yellow-400 ml-1"></i></div>
                        </div>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>
                
                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
                     data-product-name="Vintage Style Tiebacks" data-product-price="650">
                    <div>
                        <div class="h-64 rounded-lg mb-4 overflow-hidden">
                            <img src="acce4.jpg" alt="Vintage style curtain tiebacks" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                        </div>
                        <h3 class="font-medium mb-2">Vintage Style Tiebacks</h3>
                        <p class="text-gray-600 mb-2 flex-grow">Bring a vintage charm to your curtains with our beautifully crafted tiebacks.</p>
                         <div class="flex flex-col space-y-2 mb-4 items-center">
                            <label for="qty-4" class="text-sm font-medium">Quantity:</label>
                            <input type="number" id="qty-4" value="1" min="1" class="quantity-input border p-1 rounded-md w-16 text-center" oninput="updateTotalPrice(this)" onchange="this.value = Math.max(1, this.value || 1)">
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-lg product-price-display">â‚± 650</span>
                            <div class="flex items-center"><span>4.4</span><i class="fas fa-star text-yellow-400 ml-1"></i></div>
                        </div>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>

                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
                     data-product-name="Modern Geometric Tiebacks" data-product-price="650">
                    <div>
                        <div class="h-64 rounded-lg mb-4 overflow-hidden">
                            <img src="acce5.jpg" alt="Modern geometric tiebacks" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                        </div>
                        <h3 class="font-medium mb-2">Modern Geometric Tiebacks</h3>
                        <p class="text-gray-600 mb-2 flex-grow">Add a contemporary flair to your curtains with our geometric tiebacks.</p>
                         <div class="flex flex-col space-y-2 mb-4 items-center">
                            <label for="qty-5" class="text-sm font-medium">Quantity:</label>
                            <input type="number" id="qty-5" value="1" min="1" class="quantity-input border p-1 rounded-md w-16 text-center" oninput="updateTotalPrice(this)" onchange="this.value = Math.max(1, this.value || 1)">
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-lg product-price-display">â‚± 650</span>
                            <div class="flex items-center"><span>4.7</span><i class="fas fa-star text-yellow-400 ml-1"></i></div>
                        </div>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>

                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
                     data-product-name="Floral Tiebacks" data-product-price="700">
                    <div>
                        <div class="h-64 rounded-lg mb-4 overflow-hidden">
                            <img src="acce6.jpg" alt="Floral tiebacks" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                        </div>
                        <h3 class="font-medium mb-2">Floral Tiebacks</h3>
                        <p class="text-gray-600 mb-2 flex-grow">Brighten your space with our floral tiebacks that add a pop of color.</p>
                         <div class="flex flex-col space-y-2 mb-4 items-center">
                            <label for="qty-6" class="text-sm font-medium">Quantity:</label>
                            <input type="number" id="qty-6" value="1" min="1" class="quantity-input border p-1 rounded-md w-16 text-center" oninput="updateTotalPrice(this)" onchange="this.value = Math.max(1, this.value || 1)">
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-lg product-price-display">â‚± 700</span>
                            <div class="flex items-center"><span>4.8</span><i class="fas fa-star text-yellow-400 ml-1"></i></div>
                        </div>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>

                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
                     data-product-name="Beaded Tiebacks" data-product-price="720">
                    <div>
                        <div class="h-64 rounded-lg mb-4 overflow-hidden">
                            <img src="acce7.jpg" alt="Beaded tiebacks" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                        </div>
                        <h3 class="font-medium mb-2">Beaded Tiebacks</h3>
                        <p class="text-gray-600 mb-2 flex-grow">Add a touch of glamour with our beaded tiebacks.</p>
                         <div class="flex flex-col space-y-2 mb-4 items-center">
                            <label for="qty-7" class="text-sm font-medium">Quantity:</label>
                            <input type="number" id="qty-7" value="1" min="1" class="quantity-input border p-1 rounded-md w-16 text-center" oninput="updateTotalPrice(this)" onchange="this.value = Math.max(1, this.value || 1)">
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-lg product-price-display">â‚± 720</span>
                            <div class="flex items-center"><span>4.9</span><i class="fas fa-star text-yellow-400 ml-1"></i></div>
                        </div>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>

                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
                     data-product-name="Satin Tiebacks" data-product-price="720">
                    <div>
                        <div class="h-64 rounded-lg mb-4 overflow-hidden">
                            <img src="acce8.jpg" alt="Satin tiebacks" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                        </div>
                        <h3 class="font-medium mb-2">Satin Tiebacks</h3>
                        <p class="text-gray-600 mb-2 flex-grow">Luxurious satin tiebacks that add elegance to any curtain.</p>
                         <div class="flex flex-col space-y-2 mb-4 items-center">
                            <label for="qty-8" class="text-sm font-medium">Quantity:</label>
                            <input type="number" id="qty-8" value="1" min="1" class="quantity-input border p-1 rounded-md w-16 text-center" oninput="updateTotalPrice(this)" onchange="this.value = Math.max(1, this.value || 1)">
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-lg product-price-display">â‚± 720</span>
                            <div class="flex items-center"><span>4.6</span><i class="fas fa-star text-yellow-400 ml-1"></i></div>
                        </div>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>

            </div>

        </div>
    </section>

    <footer class="bg-primary text-white py-12">
        <div class="container mx-auto px-6 md:px-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="font-playfair text-xl font-bold mb-4">World Class Curtain</h3>
                    <p class="text-gray-300">Elevate your space with our premium collection of curtains designed for modern living.</p>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-300 hover:text-white">Home</a></li>
                        <li><a href="inquiries.html" class="text-gray-300 hover:text-white">Inquiries</a></li>
                        <li><a href="accesories.html" class="text-gray-300 hover:text-white">Accessories</a></li>
                        <li><a href="seemore.html" class="text-gray-300 hover:text-white">More</a></li>
                        <li><a href="contact.html" class="text-gray-300 hover:text-white">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-300">
                <p>&copy; 2025 World Class Curtain. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script type="module">
        const supabase = window.supabase;

        // ðŸ”‘ OWNER CONFIGURATION - From index.html
        const OWNER_USER_ID = 'a07429ce-d43a-4c8f-aedf-07e06dd4ca64'; 

        // --- DOM Selectors (Merged) ---
        const authLinksContainer = document.getElementById('auth-links');
        const mobileAuthLinksContainer = document.getElementById('mobile-auth-links');
        const userWelcomeSection = document.getElementById('user-welcome');
        const userEmailDisplay = document.getElementById('user-email-display');
        const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');
        // UPDATED: Correct IDs from new nav
        const cartItemCountDesktop = document.getElementById('cart-item-count-desktop'); 
        const cartItemCountMobile = document.getElementById('cart-item-count-mobile'); 

        // --- Authentication (From index.html) ---
        async function checkUserSession() {
            const { data: { session } } = await supabase.auth.getSession();
            updateUIAfterAuth(session);
            updateCartCount(session); 
        }

        function updateUIAfterAuth(session) {
            authLinksContainer.innerHTML = ''; 
            mobileAuthLinksContainer.innerHTML = '';
            
            const isOwner = session && session.user.id === OWNER_USER_ID;

            if (session && session.user) {
                // User is logged in
                userWelcomeSection.classList.remove('hidden');
                userEmailDisplay.textContent = `Signed in as: ${session.user.email}`;

                let adminLinkDesktop = isOwner ? `<a href="admin_orders.html" class="hover:text-red-600 font-bold text-red-500">ADMIN ORDERS</a>` : '';
                const desktopLinks = `
                    ${adminLinkDesktop}
                    <a href="profile.html" class="hover:text-primary font-semibold">PROFILE</a>
                    <button id="signout-btn" class="hover:text-primary font-semibold">SIGN OUT</button>
                `;
                
                let adminLinkMobile = isOwner ? `<a href="admin_orders.html" class="block hover:text-red-600 py-2 font-bold text-red-500">ADMIN ORDERS</a>` : '';
                const mobileLinks = `
                    ${adminLinkMobile}
                    <a href="profile.html" class="block hover:text-primary py-2">PROFILE</a>
                    <button id="mobile-signout-btn" class="block hover:text-primary py-2 w-full text-left">SIGN OUT</button>
                `;
                
                authLinksContainer.innerHTML = desktopLinks;
                mobileAuthLinksContainer.innerHTML = mobileLinks;
                
                document.getElementById('signout-btn').addEventListener('click', handleSignOut);
                document.getElementById('mobile-signout-btn').addEventListener('click', handleSignOut);

            } else {
                // User is not logged in
                userWelcomeSection.classList.add('hidden');
                const desktopLinks = `<a href="login.html" class="hover:text-primary font-semibold">SIGN IN</a>`;
                const mobileLinks = `<a href="login.html" class="block hover:text-primary py-2">SIGN IN</a>`;
                authLinksContainer.innerHTML = desktopLinks;
                mobileAuthLinksContainer.innerHTML = mobileLinks;
            }
        }

        async function handleSignOut() {
            await supabase.auth.signOut();
            window.location.reload();
        }
        
        // --- Cart Logic ---

        // UPDATED updateCartCount (From index.html)
        // This now updates both counters
        async function updateCartCount(session) {
            if (!session) {
                if (cartItemCountDesktop) cartItemCountDesktop.textContent = '0';
                if (cartItemCountMobile) cartItemCountMobile.textContent = '0';
                return;
            }
            const { count, error } = await supabase
                .from('cart')
                .select('*', { count: 'exact', head: true })
                .eq('user_id', session.user.id);
            
            const itemCount = error ? '0' : (count || '0');

            if (cartItemCountDesktop) cartItemCountDesktop.textContent = itemCount;
            if (cartItemCountMobile) cartItemCountMobile.textContent = itemCount;
        }

        // KEPT: This logic is specific to accessories.html and is correct.
        async function findExistingCartItem(userId, productName, size) {
            const { data: existingItems, error } = await supabase
                .from('cart')
                .select('id, quantity')
                .eq('user_id', userId)
                .eq('product_name', productName)
                .eq('size', size)
                .single(); 

            if (error && error.code !== 'PGRST116') { // 'PGRST116' is 'No rows found'
                console.error('Error checking for existing cart item:', error);
                return null;
            }
            return existingItems;
        }

        // KEPT: This logic is specific to accessories.html and is correct.
        async function handleAddToCart(event) {
            const { data: { session } } = await supabase.auth.getSession();
            if (!session) {
                alert('Please sign in to add items to your cart.');
                window.location.href = 'login.html';
                return;
            }

            const productCard = event.target.closest('.product-card');
            
            const quantityInput = productCard.querySelector('.quantity-input');
            const selectedQuantity = parseInt(quantityInput.value);

            if (isNaN(selectedQuantity) || selectedQuantity < 1) {
                alert('Please enter a valid quantity (1 or more).');
                return;
            }

            const productName = productCard.dataset.productName;
            const unitPrice = parseFloat(productCard.dataset.productPrice);
            const size = 'N/A'; // Default size for accessories

            let alertMessage = `'${productName}' (${selectedQuantity} pc) has been added to your cart!`;
            let errorOccurred = false;

            const existingItem = await findExistingCartItem(session.user.id, productName, size);

            if (existingItem) {
                // Item exists, update quantity
                const newQuantity = existingItem.quantity + selectedQuantity;
                const { error: updateError } = await supabase
                    .from('cart')
                    .update({ quantity: newQuantity })
                    .eq('id', existingItem.id);

                if (updateError) {
                    console.error('Cart update error:', updateError);
                    errorOccurred = true;
                } else {
                    alertMessage = `Quantity for '${productName}' updated! New total: ${newQuantity} pc.`;
                }
            } else {
                // Item does not exist, insert new row
                const cartItem = {
                    user_id: session.user.id,
                    product_name: productName,
                    size: size,
                    price: unitPrice, 
                    quantity: selectedQuantity 
                };
                const { error: insertError } = await supabase.from('cart').insert([cartItem]);
                if (insertError) {
                    console.error('Cart insertion error:', insertError);
                    errorOccurred = true;
                }
            }

            if (errorOccurred) {
                alert('Sorry, there was an error adding/updating the item in the cart.');
            } else {
                alert(alertMessage);
                updateCartCount(session); // This will now update both counters
            }
        }

        // --- Event Listeners (Module) ---
        document.addEventListener('DOMContentLoaded', () => {
            checkUserSession(); // This will run auth checks and update cart count on load
            addToCartButtons.forEach(button => button.addEventListener('click', handleAddToCart));
        });

    </script>
</body>
</html>