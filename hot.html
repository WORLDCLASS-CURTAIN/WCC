<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Class Curtain - Hot Products</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" href="logoo.png" type="image/png">
    
    <style>
        /* Hero Section Styles */
        .hero { position: relative; overflow: hidden; transition: background-image 1s ease-in-out; background-size: cover; background-position: center; }
        .hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 1; }
        .hero h2, .hero p, .hero button { z-index: 2; position: relative; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7); }
        .hero button { transition: background-color 0.3s ease, transform 0.3s ease; }
        .hero button:hover { background-color: rgba(26, 27, 75, 0.8); transform: scale(1.05); }

        /* Navigation Style (Sticky to the top) */
        nav { position: sticky; top: 0; left: 0; right: 0; z-index: 1000; } 
        
        /* Animation Styles (for fade-in section) */
        .fade-in { opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease-out, transform 0.5s ease-out; }
        .fade-in.visible { opacity: 1; transform: translateY(0); }
    </style>

    <script type="module">
        import { createClient } from 'https://esm.sh/@supabase/supabase-js'
        // NOTE: Replace with actual keys in a real application
        const SUPABASE_URL = 'https://xyvqvcfdkvvbagqxygwo.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh5dnF2Y2Zka3Z2YmFncXh5Z3dvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3NTAzMjUsImV4cCI6MjA3MzMyNjMyNX0.y9mp2CwTpmBfeu03iQx_2khV2F3SD_xhFTih3WMoMMA';
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        window.supabase = supabase;
    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 'playfair': ['"Playfair Display"', 'serif'], 'poppins': ['Poppins', 'sans-serif'] },
                    colors: { 'primary': '#1a1b4b', 'secondary': '#e6f3ff' }
                }
            }
        };

        function toggleMenu() { document.getElementById('mobile-menu').classList.toggle('hidden'); }

        // Carousel functionality for hero section
        const images = ['bigi1.jpg', 'bigi2.jpg', 'bigi3.jpg'];
        let currentIndex = 0;

        function changeBackground() {
            const heroSection = document.querySelector('.hero');
            if (heroSection) {
                currentIndex = (currentIndex + 1) % images.length; // Loop through images
                heroSection.style.backgroundImage = `url('${images[currentIndex]}')`;
            }
        }
        
        // Function to handle scroll animations
        function handleScroll() {
            const elements = document.querySelectorAll('.fade-in');
            const windowHeight = window.innerHeight;

            elements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;

                if (elementTop < windowHeight - 50) { 
                    element.classList.add('visible');
                }
            });
        }

        // --- Price Update Logic (Added for Hot Products) ---
        function handleSizeChange(event) {
            const selectElement = event.target;
            const productCard = selectElement.closest('.product-card');
            if (!productCard) return;

            const priceDisplay = productCard.querySelector('.product-price-display');
            const selectedOption = selectElement.options[selectElement.selectedIndex];
            
            // Get the price from the 'data-price' attribute on the selected <option>
            const newPrice = selectedOption.dataset.price;

            if (priceDisplay && newPrice) {
                // Update the displayed price text
                priceDisplay.textContent = `â‚±${parseInt(newPrice).toLocaleString()}`;
                
                // Update the data-product-price attribute on the card for cart logic
                productCard.dataset.productPrice = newPrice;
            }
        }


        document.addEventListener('DOMContentLoaded', () => {
            // Initial background setup
            const heroSection = document.querySelector('.hero');
            if (heroSection) {
                heroSection.style.backgroundImage = `url('${images[currentIndex]}')`;
                setInterval(changeBackground, 5000); // Start the rotation
            }
            handleScroll(); // Initial call to show elements already in view

            // Attach listeners for dynamic price update
            const sizeSelectors = document.querySelectorAll('.product-size-select');
            sizeSelectors.forEach(select => {
                select.addEventListener('change', handleSizeChange);
                // Initialize price display on load
                handleSizeChange({ target: select });
            });
        });

        // Add scroll event listener
        window.addEventListener('scroll', handleScroll);
    </script>
</head>
<body class="font-poppins">
    <nav class="bg-white py-4 px-6 md:px-12 shadow-md">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="flex items-center text-2xl font-playfair font-bold text-primary">
                <img src="logoo.png" alt="World Class Curtain Logo" class="h-10 mr-2"> 
                World Class Curtain
            </a>
            
            <div class="flex items-center space-x-4 md:hidden">
                <a href="cart.html" class="hover:text-primary relative">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <span id="cart-item-count-mobile" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </a>
                <img src="menuuu.png" alt=" Menu Button" class="menu-btn cursor-pointer" id="menu-btn" onclick="toggleMenu()">
            </div>
            
            <div class="hidden md:flex space-x-8 items-center">
                <a href="index.html" class="hover:text-primary">HOME</a>
                <a href="inquiries.html" class="hover:text-primary">INQUIRIES</a>
                <a href="accesories.html" class="hover:text-primary">ACCESSORIES</a>
                <a href="seemore.html" class="hover:text-primary">MORE</a>
                <a href="contact.html" class="hover:text-primary">CONTACT</a>
                <div id="auth-links" class="flex space-x-4 items-center"></div> 
                
                <a href="cart.html" class="hover:text-primary relative">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <span id="cart-item-count-desktop" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </a>
            </div>
        </div>
        
        <div id="mobile-menu" class="hidden md:hidden bg-white py-4 px-6">
            <a href="index.html" class="block hover:text-primary py-2">HOME</a>
            <a href="inquiries.html" class="hover:text-primary">INQUIRIES</a>
            <a href="accesories.html" class="block hover:text-primary py-2">ACCESSORIES</a>
            <a href="seemore.html" class="block hover:text-primary py-2">MORE</a>
            <a href="contact.html" class="block hover:text-primary py-2">CONTACT</a>
            <div id="mobile-auth-links" class="mt-2 space-y-1"></div>
        </div>
    </nav>

    <section id="user-welcome" class="hidden py-8 bg-secondary fade-in text-center">
        <h2 class="text-2xl font-playfair font-bold text-primary">Welcome Back!</h2>
        <p id="user-email-display" class="text-gray-600"></p>
    </section>

    <section class="hero bg-secondary py-16 md:py-24 bg-cover bg-center" style="background-image: url('bigi1.jpg');">
        <div class="container mx-auto px-6 md:px-12">
            <div class="max-w-2xl relative z-10">
                <h2 class="text-4xl md:text-5xl font-playfair font-bold text-yellow-500 mb-4">Curtains That<br/>Reflect your Style</h2>
                <p class="text-yellow-500 mb-8">Explore The Elegance of World - Class<br/>Curtains, where Luxury Meets<br/>Functionality.</p>
                <button class="bg-primary text-white px-8 py-3 rounded hover:bg-opacity-90 transition" onclick="window.location.href='seemore.html'">
                    Explore Now
                </button>
            </div>
        </div>
    </section>

    <section class="py-16 fade-in bg-gray-50">
        <div class="container mx-auto px-6 md:px-12">
            <h2 class="text-3xl font-playfair font-bold text-primary text-center mb-12 fade-in">Hot Products</h2>
            <p class="text-center text-gray-600 mb-12 fade-in">Discover a range of Blackout and embroidery design that fits your style</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                
                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1 fade-in"
                     data-product-name="Blackout Curtain" 
                     data-product-price="1500">
                    <div class="h-64 rounded-lg mb-4 overflow-hidden">
                        <img src="ctdsgn21.jpg" alt="Blackout Curtain" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                    </div>
                    <h3 class="font-medium mb-2">Blackout Curtain</h3>
                    <p class="text-gray-600 mb-2 text-sm flex-grow">The minimalist design features a sleek, solid color that complements any decor, making it a versatile addition to your home.</p>
                    <div class="flex justify-between items-center mt-2">
                        <span class="font-bold text-lg product-price-display">â‚±1,500</span> <div class="flex items-center">
                            <span>4.8</span>
                            <i class="fas fa-star text-yellow-400 ml-1"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <label for="size-4" class="block text-sm font-medium text-gray-700">Size:</label>
                        <select id="size-4" class="product-size-select mt-1 block w-full pl-3 pr-10 py-2 border-gray-300 rounded-md">
                             <option value="Standard (52&quot; W x 84&quot; L)" data-price="1500">Standard (52" W x 84" L) - â‚±1,500</option>
                            <option value="Long (52&quot; W x 96&quot; L)" data-price="1700">Long (52" W x 96" L) - â‚±1,700</option>
                            <option value="Extra-Long (52&quot; W x 108&quot; L)" data-price="1900">Extra-Long (52" W x 108" L) - â‚±1,900</option>
                        </select>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>

                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1 fade-in"
                     data-product-name="Embroidery Curtain (Design A)" 
                     data-product-price="1800">
                    <div class="h-64 rounded-lg mb-4 overflow-hidden">
                        <img src="ctdsgn22.jpg" alt="Embroidery Curtain Design A" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                    </div>
                    <h3 class="font-medium mb-2">Embroidery Curtain</h3>
                    <p class="text-gray-600 mb-2 text-sm flex-grow">This product is trending and loved by our customers for its delicate embroidery.</p>
                    <div class="flex justify-between items-center mt-2">
                        <span class="font-bold text-lg product-price-display">â‚±1,800</span> <div class="flex items-center">
                            <span>4.9</span>
                            <i class="fas fa-star text-yellow-400 ml-1"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <label for="size-5" class="block text-sm font-medium text-gray-700">Size:</label>
                        <select id="size-5" class="product-size-select mt-1 block w-full pl-3 pr-10 py-2 border-gray-300 rounded-md">
                            <option value="Standard (52&quot; W x 84&quot; L)" data-price="1800">Standard (52" W x 84" L) - â‚±1,800</option>
                            <option value="Long (52&quot; W x 96&quot; L)" data-price="2050">Long (52" W x 96" L) - â‚±2,050</option>
                            <option value="Extra-Long (52&quot; W x 108&quot; L)" data-price="2300">Extra-Long (52" W x 108" L) - â‚±2,300</option>
                        </select>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>

                <div class="product-card bg-gray-100 p-4 rounded-lg transform transition-all duration-300 hover:shadow-xl hover:-translate-y-1 fade-in"
                     data-product-name="Embroidery Curtain (Design B)" 
                     data-product-price="1750">
                    <div class="h-64 rounded-lg mb-4 overflow-hidden">
                        <img src="ctdsgn23.jpg" alt="Embroidery Curtain Design B" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                    </div>
                    <h3 class="font-medium mb-2">Embroidery Curtain</h3>
                    <p class="text-gray-600 mb-2 text-sm flex-grow">This product is trending and loved by our customers.</p>
                    <div class="flex justify-between items-center mt-2">
                        <span class="font-bold text-lg product-price-display">â‚±1,750</span> <div class="flex items-center">
                            <span>4.7</span>
                            <i class="fas fa-star text-yellow-400 ml-1"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <label for="size-6" class="block text-sm font-medium text-gray-700">Size:</label>
                        <select id="size-6" class="product-size-select mt-1 block w-full pl-3 pr-10 py-2 border-gray-300 rounded-md">
                            <option value="Standard (52&quot; W x 84&quot; L)" data-price="1750">Standard (52" W x 84" L) - â‚±1,750</option>
                            <option value="Long (52&quot; W x 96&quot; L)" data-price="1980">Long (52" W x 96" L) - â‚±1,980</option>
                            <option value="Extra-Long (52&quot; W x 108&quot; L)" data-price="2200">Extra-Long (52" W x 108" L) - â‚±2,200</option>
                        </select>
                    </div>
                    <button class="add-to-cart-btn mt-4 w-full bg-primary text-white py-2 rounded-md hover:bg-opacity-90 font-semibold transition-colors">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-primary text-white py-12">
        <div class="container mx-auto px-6 md:px-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="font-playfair text-xl font-bold mb-4">World Class Curtain</h3>
                    <p class="text-gray-300">Elevate your space with our premium collection of curtains designed for modern living.</p>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-300 hover:text-white">Home</a></li>
                        <li><a href="accesories.html" class="text-gray-300 hover:text-white">Accessories</a></li>
                        <li><a href="seemore.html" class="text-gray-300 hover:text-white">More</a></li>
                        <li><a href="contact.html" class="text-gray-300 hover:text-white">Contact</a></li>
                    </ul>
                </div>
                <div></div>
                <div></div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-300">
                <p>&copy; 2025 World Class Curtain. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <script type="module">
        const supabase = window.supabase;

        // ðŸ”‘ OWNER CONFIGURATION - REPLACE THIS WITH YOUR ADMIN USER'S UUID IF YOU NEED ADMIN LINKS!
        const OWNER_USER_ID = 'a07429ce-d43a-4c8f-aedf-07e06dd4ca64'; 

        // --- DOM Selectors ---
        const authLinksContainer = document.getElementById('auth-links');
        const mobileAuthLinksContainer = document.getElementById('mobile-auth-links');
        const userWelcomeSection = document.getElementById('user-welcome');
        const userEmailDisplay = document.getElementById('user-email-display');
        const cartItemCountDesktop = document.getElementById('cart-item-count-desktop'); 
        const cartItemCountMobile = document.getElementById('cart-item-count-mobile');
        
        // --- Authentication ---
        async function checkUserSession() {
            const { data: { session } } = await supabase.auth.getSession();
            updateUIAfterAuth(session);
            updateCartCount(session);
        }

        function updateUIAfterAuth(session) {
            authLinksContainer.innerHTML = ''; 
            mobileAuthLinksContainer.innerHTML = '';
            
            const isOwner = session && session.user.id === OWNER_USER_ID;

            if (session && session.user) {
                // User is logged in
                userWelcomeSection.classList.remove('hidden');
                userEmailDisplay.textContent = `Signed in as: ${session.user.email}`;

                let adminLink = isOwner ? 
                    `<a href="admin_orders.html" class="hover:text-red-600 font-bold text-red-500">ADMIN</a>` : 
                    '';

                // Desktop Links
                const desktopLinks = `
                    ${adminLink}
                    <a href="profile.html" class="hover:text-primary font-semibold">PROFILE</a>
                    <button id="signout-btn" class="hover:text-primary font-semibold">SIGN OUT</button>
                `;
                authLinksContainer.innerHTML = desktopLinks;
                
                // Mobile Links
                adminLink = isOwner ? 
                    `<a href="admin_orders.html" class="block hover:text-red-600 py-2 font-bold text-red-500">ADMIN</a>` : 
                    '';

                const mobileLinks = `
                    ${adminLink}
                    <a href="profile.html" class="block hover:text-primary py-2">PROFILE</a>
                    <button id="mobile-signout-btn" class="block hover:text-primary py-2 w-full text-left">SIGN OUT</button>
                `;
                mobileAuthLinksContainer.innerHTML = mobileLinks;
                
                // Attach event listeners
                const signoutBtn = document.getElementById('signout-btn');
                const mobileSignoutBtn = document.getElementById('mobile-signout-btn');
                if (signoutBtn) signoutBtn.addEventListener('click', handleSignOut);
                if (mobileSignoutBtn) mobileSignoutBtn.addEventListener('click', handleSignOut);

            } else {
                // User is not logged in
                userWelcomeSection.classList.add('hidden');
                const desktopLinks = `<a href="login.html" class="hover:text-primary font-semibold">SIGN IN</a>`;
                const mobileLinks = `<a href="login.html" class="block hover:text-primary py-2">SIGN IN</a>`;
                authLinksContainer.innerHTML = desktopLinks;
                mobileAuthLinksContainer.innerHTML = mobileLinks;
            }
        }

        async function handleSignOut() {
            await supabase.auth.signOut();
            window.location.reload();
        }
        
        // --- Cart Logic ---
        async function updateCartCount(session) {
            if (!session) {
                if (cartItemCountDesktop) cartItemCountDesktop.textContent = '0';
                if (cartItemCountMobile) cartItemCountMobile.textContent = '0';
                return;
            }
            const { count, error } = await supabase
                .from('cart')
                .select('*', { count: 'exact', head: true })
                .eq('user_id', session.user.id);
            
            const itemCount = error ? '0' : (count || '0');

            if (cartItemCountDesktop) cartItemCountDesktop.textContent = itemCount;
            if (cartItemCountMobile) cartItemCountMobile.textContent = itemCount;
        }

        async function handleAddToCart(event) {
            const { data: { session } } = await supabase.auth.getSession();
            if (!session) {
                alert('Please sign in to add items to your cart.');
                window.location.href = 'login.html'; // Redirect to login page
                return;
            }

            const productCard = event.target.closest('.product-card');
            const sizeSelector = productCard.querySelector('.product-size-select');

            if (!sizeSelector) {
                alert('Error: Size selection is missing.');
                return;
            }
            
            // The price is now dynamically updated on the card's data-attribute by handleSizeChange
            const cartItem = {
                user_id: session.user.id,
                product_name: productCard.dataset.productName,
                size: sizeSelector.value, 
                price: parseFloat(productCard.dataset.productPrice),
                quantity: 1
            };

            const { error } = await supabase.from('cart').insert([cartItem]);
            if (error) {
                alert('Sorry, there was an error adding the item.');
                console.error('Supabase error:', error);
            } else {
                alert(`'${cartItem.product_name}' has been added to your cart!`);
                updateCartCount(session);
            }
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Check session and update auth links/cart count
            checkUserSession();
            
            // Attach event listeners to all "Add to Cart" buttons
            const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');
            addToCartButtons.forEach(button => button.addEventListener('click', handleAddToCart));
        });
    </script>
</body>
</html>